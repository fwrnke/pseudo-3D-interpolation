
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://fwrnke.github.io/pseudo-3D-interpolation/api/functions/api_filter/">
      
      
        <link rel="prev" href="../api_backends/">
      
      
        <link rel="next" href="../api_header/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.9">
    
    
      
        <title>filter.py - Pseudo-3D interpolation workflow</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#filterpy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Pseudo-3D interpolation workflow" class="md-header__button md-logo" aria-label="Pseudo-3D interpolation workflow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15 6.04 7.5 12 10.85l5.96-3.35L12 4.15M5 15.91l6 3.38v-6.71L5 9.21v6.7m14 0v-6.7l-6 3.37v6.71l6-3.38Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pseudo-3D interpolation workflow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              filter.py
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/fwrnke/pseudo-3D-interpolation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Pseudo-3D interpolation
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../2D/merge_segys/" class="md-tabs__link">
        2D processing
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../3D/cube_binning_geometry/" class="md-tabs__link">
        3D interpolation
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../citation/" class="md-tabs__link">
      Citation
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../contact/" class="md-tabs__link">
      Contact
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../license/" class="md-tabs__link">
      License
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../api_merge_segys/" class="md-tabs__link md-tabs__link--active">
        API documentation
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Pseudo-3D interpolation workflow" class="md-nav__button md-logo" aria-label="Pseudo-3D interpolation workflow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15 6.04 7.5 12 10.85l5.96-3.35L12 4.15M5 15.91l6 3.38v-6.71L5 9.21v6.7m14 0v-6.7l-6 3.37v6.71l6-3.38Z"/></svg>

    </a>
    Pseudo-3D interpolation workflow
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/fwrnke/pseudo-3D-interpolation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    Pseudo-3D interpolation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          2D processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          2D processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/merge_segys/" class="md-nav__link">
        SEG-Y merging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/coordinate_conversion/" class="md-nav__link">
        Coordinate conversion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/correct_delrt/" class="md-nav__link">
        DelayRecordingTime correction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/pad_vertical_offsets/" class="md-nav__link">
        Vertical offsets padding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/static_correction/" class="md-nav__link">
        Static correction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/tide_compensation/" class="md-nav__link">
        Tide compensation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/mistie_correction/" class="md-nav__link">
        Mistie correction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/2D_despike/" class="md-nav__link">
        Despiking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../2D/convert_segy2netcdf/" class="md-nav__link">
        SEG-Y to netCDF conversion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          3D interpolation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          3D interpolation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/cube_binning_geometry/" class="md-nav__link">
        Binning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/preprocessing_3D/" class="md-nav__link">
        Pre-processing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/apply_FFT_3D/" class="md-nav__link">
        Time to frequency domain (forward FFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/3D_cube_interpolation/" class="md-nav__link">
        3D interpolation (POCS)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/apply_inverse_FFT_3D/" class="md-nav__link">
        Frequency to time domain (inverse FFT)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../3D/convert_netcdf2segy_3D/" class="md-nav__link">
        netCDF to SEG-Y conversion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../citation/" class="md-nav__link">
        Citation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../contact/" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          API documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          API documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_merge_segys/" class="md-nav__link">
        01_merge_segys
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_reproject_segy/" class="md-nav__link">
        02_reproject_segy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_delrt_correction_segy/" class="md-nav__link">
        03_correct_delrt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_delrt_padding_segy/" class="md-nav__link">
        04_pad_delrt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_static_correction_segy/" class="md-nav__link">
        05_correct_static
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_tide_compensation_segy/" class="md-nav__link">
        06_compensate_tide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_mistie_correction_segy/" class="md-nav__link">
        07_correct_mistie
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_despiking_2D_segy/" class="md-nav__link">
        08_despike
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cnv_segy2netcdf/" class="md-nav__link">
        09_convert_segy2netcdf
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_binning_3D/" class="md-nav__link">
        10_cube_geometry_binning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_preprocessing_3D/" class="md-nav__link">
        11_cube_preprocessing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_apply_FFT/" class="md-nav__link">
        12_cube_apply_FFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_POCS_interpolation_3D/" class="md-nav__link">
        13_cube_interpolate_POCS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_apply_IFFT/" class="md-nav__link">
        14_cube_apply_IFFT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api_cube_cnv_netcdf2segy_3D/" class="md-nav__link">
        15_cube_cnv_netcdf2segy
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_16" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7_16" id="__nav_7_16_label" tabindex="0">
          Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_16_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7_16">
          <span class="md-nav__icon md-icon"></span>
          Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_backends/" class="md-nav__link">
        backends
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          filter
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        filter
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_window" class="md-nav__link">
    moving_window()
  </a>
  
    <nav class="md-nav" aria-label="moving_window()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_window--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_average" class="md-nav__link">
    moving_average()
  </a>
  
    <nav class="md-nav" aria-label="moving_average()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_average--reference" class="md-nav__link">
    Reference
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_average_convolve" class="md-nav__link">
    moving_average_convolve()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_median" class="md-nav__link">
    moving_median()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_window_2D" class="md-nav__link">
    moving_window_2D()
  </a>
  
    <nav class="md-nav" aria-label="moving_window_2D()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_window_2D--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation" class="md-nav__link">
    median_abs_deviation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation_double" class="md-nav__link">
    median_abs_deviation_double()
  </a>
  
    <nav class="md-nav" aria-label="median_abs_deviation_double()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation_double--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.smooth" class="md-nav__link">
    smooth()
  </a>
  
    <nav class="md-nav" aria-label="smooth()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.smooth--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.zscore_filter" class="md-nav__link">
    zscore_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_zscore_filter" class="md-nav__link">
    moving_zscore_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.iqr_filter" class="md-nav__link">
    iqr_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.mad_filter" class="md-nav__link">
    mad_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.moving_mad_filter" class="md-nav__link">
    moving_mad_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.polynominal_filter" class="md-nav__link">
    polynominal_filter()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.filter_interp_1d" class="md-nav__link">
    filter_interp_1d()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter" class="md-nav__link">
    sta_lta_filter()
  </a>
  
    <nav class="md-nav" aria-label="sta_lta_filter()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.detect_seafloor_reflection" class="md-nav__link">
    detect_seafloor_reflection()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.butterworth_filter" class="md-nav__link">
    butterworth_filter()
  </a>
  
    <nav class="md-nav" aria-label="butterworth_filter()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.butterworth_filter--references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudo_3D_interpolation.functions.filter.filter_frequency" class="md-nav__link">
    filter_frequency()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_header/" class="md-nav__link">
        header
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_plot/" class="md-nav__link">
        plot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_POCS/" class="md-nav__link">
        POCS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_signal/" class="md-nav__link">
        signal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_threshold_operator/" class="md-nav__link">
        threshold_operator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_transform/" class="md-nav__link">
        transform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_utils/" class="md-nav__link">
        utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api_utils_IO/" class="md-nav__link">
        utils_IO
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<h1 id="filterpy"><code>filter.py</code><a class="headerlink" href="#filterpy" title="Permanent link">#</a></h1>


<div class="doc doc-object doc-module">



  <div class="doc doc-contents first">
  
      <p>Utility functions to filter (multidimensional) data.</p>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">window_length</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_window" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create moving windows of given window length over input array (as view).</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>a</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>1D input array.</p>
      </li>
      <li class="field-body">
        <b>window_length</b>
            (<code>int</code>)
        – <p>Length of moving window.</p>
      </li>
      <li class="field-body">
        <b>step_size</b>
            (<code>int</code>)
        – <p>Step size of moving window (default: 1).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>view</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>View of array according to <code>window_length</code> and <code>step_size</code>.</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.moving_window--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.moving_window--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.moving_window--fn:1">
<p><a href="https://stackoverflow.com/a/6811241">https://stackoverflow.com/a/6811241</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.moving_window--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="pseudo_3D_interpolation.functions.filter.moving_window--fn:2">
<p><a href="https://rigtorp.se/2011/01/01/rolling-statistics-numpy.html">https://rigtorp.se/2011/01/01/rolling-statistics-numpy.html</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.moving_window--fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="pseudo_3D_interpolation.functions.filter.moving_window--fn:3">
<p><a href="https://gist.github.com/codehacken/708f19ae746784cef6e68b037af65788">https://gist.github.com/codehacken/708f19ae746784cef6e68b037af65788</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.moving_window--fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="k">def</span> <span class="nf">moving_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">window_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Create moving windows of given window length over input array (as view).</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    a : np.ndarray</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        1D input array.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    window_length : int</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        Length of moving window.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    step_size : int</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        Step size of moving window (default: 1).</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    -------</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    view : np.ndarray</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        View of array according to `window_length` and `step_size`.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    References</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    [^1]: [https://stackoverflow.com/a/6811241](https://stackoverflow.com/a/6811241)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    [^2]: [https://rigtorp.se/2011/01/01/rolling-statistics-numpy.html](https://rigtorp.se/2011/01/01/rolling-statistics-numpy.html)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    [^3]: [https://gist.github.com/codehacken/708f19ae746784cef6e68b037af65788](https://gist.github.com/codehacken/708f19ae746784cef6e68b037af65788)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">shape</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">window_length</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">step_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">window_length</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">strides</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strides</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">step_size</span><span class="p">,)</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_average" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_average</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_average" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply simple non-weighted moving average.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>a</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>1D input data.</p>
      </li>
      <li class="field-body">
        <b>win</b>
            (<code>int, optional</code>)
        – <p>Number of data points within moving window (default: <code>3</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
        – <p>Moving average of input data.</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.moving_average--reference">Reference<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.moving_average--reference" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.moving_average--fn:1">
<p><a href="https://stackoverflow.com/a/42867926">https://stackoverflow.com/a/42867926</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.moving_average--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="k">def</span> <span class="nf">moving_average</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Apply simple non-weighted moving average.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    a : np.ndarray</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        1D input data.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    win : int, optional</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        Number of data points within moving window (default: `3`).</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    -------</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        Moving average of input data.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Reference</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    ---------</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    [^1]: [https://stackoverflow.com/a/42867926](https://stackoverflow.com/a/42867926)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">ret</span><span class="p">[</span><span class="n">win</span><span class="p">:]</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="n">win</span><span class="p">:]</span> <span class="o">-</span> <span class="n">ret</span><span class="p">[:</span><span class="o">-</span><span class="n">win</span><span class="p">]</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">return</span> <span class="n">ret</span><span class="p">[</span><span class="n">win</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">win</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_average_convolve" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_average_convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_average_convolve" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute moving average of array with given window length.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>x</b>
            (<code><span title="numpy">np</span>.<span title="numpy.array">array</span></code>)
        – <p>1D input data.</p>
      </li>
      <li class="field-body">
        <b>win</b>
            (<code>int, optional</code>)
        – <p>Number of data points within moving window (default: <code>3</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.array">array</span></code>
        – <p>Moving average of input data.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="k">def</span> <span class="nf">moving_average_convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">win</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Compute moving average of array with given window length.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    x : np.array</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        1D input data.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    win : int, optional</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Number of data points within moving window (default: `3`).</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    -------</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    np.array</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        Moving average of input data.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">win</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">win</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_median" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_median" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply moving median of given window size.
Optional padding of input array using half the window size to avoid edge effects.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>a</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input data (1D).</p>
      </li>
      <li class="field-body">
        <b>win</b>
            (<code>int, optional</code>)
        – <p>Number of data points within moving window (default: <code>3</code>).</p>
      </li>
      <li class="field-body">
        <b>padded</b>
            (<code>bool, optional</code>)
        – <p>Pad start and end of array (default: <code>False</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
        – <p>Moving median of input data.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="k">def</span> <span class="nf">moving_median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Apply moving median of given window size.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Optional padding of input array using half the window size to avoid edge effects.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    a : np.ndarray</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        Input data (1D).</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    win : int, optional</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Number of data points within moving window (default: `3`).</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    padded : bool, optional</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        Pad start and end of array (default: `False`).</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    -------</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        Moving median of input data.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="k">if</span> <span class="n">padded</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">half_win</span> <span class="o">=</span> <span class="p">(</span><span class="n">win</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">pad_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">half_win</span><span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">windows</span> <span class="o">=</span> <span class="n">moving_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">win</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_window_2D" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_window_2D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">writeable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_window_2D" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create an array of moving windows (as view) into the input array using given step sizes in both dimensions.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>a</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>2D input array.</p>
      </li>
      <li class="field-body">
        <b>w</b>
            (<code>tuple</code>)
        – <p>Moving window shape.</p>
      </li>
      <li class="field-body">
        <b>dx</b>
            (<code>int, optional</code>)
        – <p>Horizontal step size (columns, e.g. traces) (default: 1).</p>
      </li>
      <li class="field-body">
        <b>dy</b>
            (<code>int, optional</code>)
        – <p>vertical step size (rows, e.g. time samples) (default: 1).</p>
      </li>
      <li class="field-body">
        <b>writeable</b>
            (<code>bool, optional</code>)
        – <p>Set if view should be writeable (default: False). <strong>Use with care!</strong></p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>view</b>(            <code>numpy.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>4D array representing view of input array.</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.moving_window_2D--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.moving_window_2D--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.moving_window_2D--fn:1">
<p><a href="https://colab.research.google.com/drive/1Zru_-zzbtylgitbwxbi0eDBNhwr8qYl6#scrollTo=tXDRG-5-2jBV">https://colab.research.google.com/drive/1Zru_-zzbtylgitbwxbi0eDBNhwr8qYl6#scrollTo=tXDRG-5-2jBV</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.moving_window_2D--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="k">def</span> <span class="nf">moving_window_2D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">writeable</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    Create an array of moving windows (as view) into the input array using given step sizes in both dimensions.</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    a : np.ndarray</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        2D input array.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    w : tuple</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Moving window shape.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    dx : int, optional</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        Horizontal step size (columns, e.g. traces) (default: 1).</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    dy : int, optional</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        vertical step size (rows, e.g. time samples) (default: 1).</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    writeable : bool, optional</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        Set if view should be writeable (default: False). **Use with care!**</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    -------</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    view : numpy.ndarray</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        4D array representing view of input array.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    References</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    [^1]: [https://colab.research.google.com/drive/1Zru_-zzbtylgitbwxbi0eDBNhwr8qYl6#scrollTo=tXDRG-5-2jBV](https://colab.research.google.com/drive/1Zru_-zzbtylgitbwxbi0eDBNhwr8qYl6#scrollTo=tXDRG-5-2jBV)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">//</span> <span class="n">dy</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">//</span> <span class="n">dx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">w</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">strides</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,)</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,)</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">strides</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">stride_tricks</span><span class="o">.</span><span class="n">as_strided</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="n">strides</span><span class="p">,</span> <span class="n">writeable</span><span class="o">=</span><span class="n">writeable</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.median_abs_deviation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return the median absolute deviation (MAD) from given input array.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>x</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input array.</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>mad</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>Median absolute deviation (MAD) of input array.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="k">def</span> <span class="nf">median_abs_deviation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Return the median absolute deviation (MAD) from given input array.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    x : np.ndarray</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Input array.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    -------</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">    mad : np.ndarray</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        Median absolute deviation (MAD) of input array.</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)))</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input arrays with &lt; </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s1"> &gt; dimensions are not supported!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">return</span> <span class="n">mad</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.median_abs_deviation_double" class="doc doc-heading">
<code class="highlight language-python"><span class="n">median_abs_deviation_double</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation_double" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return the median absolute deviation (MAD) for unsymmetric distributions.
Computes the deviation from median for both sides (left &amp; right).</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>x</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input array.</p>
      </li>
      <li class="field-body">
        <b>axis</b>
            (<code>TYPE, optional</code>)
        – <p>Axis to compute median on (default: -1).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>mad</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>Median absolute deviation (MAD) of input array.</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.median_abs_deviation_double--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation_double--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.median_abs_deviation_double--fn:1">
<p><a href="https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/">https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.median_abs_deviation_double--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="k">def</span> <span class="nf">median_abs_deviation_double</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Return the median absolute deviation (MAD) for unsymmetric distributions.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    Computes the deviation from median for both sides (left &amp; right).</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    x : np.ndarray</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Input array.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    axis : TYPE, optional</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Axis to compute median on (default: -1).</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    -------</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    mad : np.ndarray</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        Median absolute deviation (MAD) of input array.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    References</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    [^1]: [https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/](https://eurekastatistics.com/using-the-median-absolute-deviation-to-find-outliers/)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">med</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">mad_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">med</span><span class="p">])</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">mad_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">med</span><span class="p">])</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">if</span> <span class="n">mad_left</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">mad_right</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;one side of median absolute deviation is zero&#39;</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">mad_left</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="n">mad</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">med</span><span class="p">]</span> <span class="o">=</span> <span class="n">mad_right</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="c1"># compute median for each window</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="n">med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="c1"># difference from median (per window)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">med</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="c1"># define column of reference value (in window)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">idx_col</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># left side MAD</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">mad_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">[(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">med</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="n">idx_col</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">mad_left</span><span class="p">[</span><span class="n">mad_left</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># right side MAD</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">mad_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">diff</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">med</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="n">idx_col</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">mad_right</span><span class="p">[</span><span class="n">mad_right</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="c1"># create and fill output array</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">mad</span><span class="p">[(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">med</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="n">idx_col</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mad_left</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">mad</span><span class="p">[(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">med</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">])[:,</span> <span class="n">idx_col</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mad_right</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input arrays with &lt; </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s1"> &gt; dimensions are not supported!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">return</span> <span class="n">mad</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.smooth" class="doc doc-heading">
<code class="highlight language-python"><span class="n">smooth</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_len</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.smooth" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>1D input data array.</p>
      </li>
      <li class="field-body">
        <b>window_len</b>
            (<code>int, optional</code>)
        – <p>Input window length, should be odd integer (default: 11).</p>
      </li>
      <li class="field-body">
        <b>window</b>
            (<code>str, optional</code>)
        – <p>Tpye of smoothing window function (default: 'hanning').</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>out</b>        – <p>smoothed input data</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.smooth--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.smooth--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.smooth--fn:1">
<p><a href="https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html">https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.smooth--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="k">def</span> <span class="nf">smooth</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_len</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">):</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Smooth the data using a window with requested size.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    This method is based on the convolution of a scaled window with the signal.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    The signal is prepared by introducing reflected copies of the signal</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    (with the window size) in both ends so that transient parts are minimized</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">    in the begining and end part of the output signal.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        1D input data array.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    window_len : int, optional</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        Input window length, should be odd integer (default: 11).</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    window : str, optional</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        Tpye of smoothing window function (default: &#39;hanning&#39;).</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">    -------</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    out :</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        smoothed input data</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">    References</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    [^1]: [https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html](https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;smooth only accepts 1 dimension arrays.&#39;</span><span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">window_len</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="sa">f</span><span class="s1">&#39;Input data should be longer (</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1">) than the window length (</span><span class="si">{</span><span class="n">window_len</span><span class="si">}</span><span class="s1">).&#39;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">if</span> <span class="n">window_len</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="k">return</span> <span class="n">data</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="k">if</span> <span class="n">window</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;flat&#39;</span><span class="p">,</span> <span class="s1">&#39;hanning&#39;</span><span class="p">,</span> <span class="s1">&#39;hamming&#39;</span><span class="p">,</span> <span class="s1">&#39;bartlett&#39;</span><span class="p">,</span> <span class="s1">&#39;blackman&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Window is one of &#39;flat&#39;, &#39;hanning&#39;, &#39;hamming&#39;, &#39;bartlett&#39;, &#39;blackman&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">if</span> <span class="n">window_len</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># even</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">window_len</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">window_len</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># odd</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">window_len</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">window_len</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="c1"># print(f&#39;left: {left}, right {right} &#39;)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">left</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span> <span class="p">:</span> <span class="o">-</span><span class="n">right</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="c1"># print(&#39;padded signal: &#39;, len(s))</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="s1">&#39;flat&#39;</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window_len</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">w</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;np.&#39;</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="s1">&#39;(window_len)&#39;</span><span class="p">)</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">w</span> <span class="o">/</span> <span class="n">w</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.zscore_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.zscore_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Z-score filter for outlier detection. Return array of outlier indices.</p>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="k">def</span> <span class="nf">zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Z-score filter for outlier detection. Return array of outlier indices.&quot;&quot;&quot;</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_zscore_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_zscore_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Return array of outlier indices using moving z-score filter for outlier detection of length <code>win</code>.</p>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="k">def</span> <span class="nf">moving_zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># noqa</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    Return array of outlier indices using moving z-score filter for outlier detection of length `win`.</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">mean</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_len</span><span class="o">=</span><span class="n">win</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">)</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">z_score</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">z_score</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.iqr_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">iqr_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.iqr_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Inter-quartile range (IQR) filter for outlier detection. Return array of outlier indices.</p>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="k">def</span> <span class="nf">iqr_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Inter-quartile range (IQR) filter for outlier detection. Return array of outlier indices.&quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">quantiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">q1</span> <span class="o">=</span> <span class="n">quantiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">q3</span> <span class="o">=</span> <span class="n">quantiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="n">iqr_upper</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">iqr_lower</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">iqr_lower</span><span class="p">,</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">iqr_upper</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.mad_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mad_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.mad_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Median Absolute Deviation (MAD) filter. Return array of outlier indices.</p>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="k">def</span> <span class="nf">mad_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">):</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Median Absolute Deviation (MAD) filter. Return array of outlier indices.&quot;&quot;&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">if</span> <span class="n">mad_mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="k">elif</span> <span class="n">mad_mode</span> <span class="o">==</span> <span class="s1">&#39;double&#39;</span><span class="p">:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="n">mad</span> <span class="o">=</span> <span class="n">median_abs_deviation_double</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">med</span><span class="p">)</span> <span class="o">/</span> <span class="n">mad</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.moving_mad_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">moving_mad_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.moving_mad_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Moving Median Absolute Deviation (MAD) filter of length <code>win</code>. Return array of outlier indices.</p>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="k">def</span> <span class="nf">moving_mad_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">):</span>  <span class="c1"># noqa</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Moving Median Absolute Deviation (MAD) filter of length `win`. Return array of outlier indices.&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">win</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">win</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;window length must be odd integer&#39;</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="n">win_half</span> <span class="o">=</span> <span class="p">(</span><span class="n">win</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="c1"># pad start and end of input array</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="n">a_pad</span> <span class="o">=</span> <span class="n">pad_array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">win_half</span><span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="c1"># create moving windows (as views)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">windows</span> <span class="o">=</span> <span class="n">moving_window</span><span class="p">(</span><span class="n">a_pad</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">win</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="c1"># compute moving median</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">moving_med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">windows</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="c1"># compute moving MAD</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="k">if</span> <span class="n">mad_mode</span> <span class="o">==</span> <span class="s1">&#39;single&#39;</span><span class="p">:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">moving_mad</span> <span class="o">=</span> <span class="n">median_abs_deviation</span><span class="p">(</span><span class="n">windows</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="k">elif</span> <span class="n">mad_mode</span> <span class="o">==</span> <span class="s1">&#39;double&#39;</span><span class="p">:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">moving_mad</span> <span class="o">=</span> <span class="n">median_abs_deviation_double</span><span class="p">(</span><span class="n">windows</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="c1"># account for case MAD == 0 (prone to false outlier detection)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">moving_mad</span><span class="p">[</span><span class="n">moving_mad</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">moving_med</span><span class="p">)</span> <span class="o">/</span> <span class="n">moving_mad</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.polynominal_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">polynominal_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.polynominal_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply polynominal filter to input data.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input data.</p>
      </li>
      <li class="field-body">
        <b>order</b>
            (<code>int, optional</code>)
        – <p>Filter order (default: <code>3</code>).</p>
      </li>
      <li class="field-body">
        <b>kind</b>
            (<code>str, optional</code>)
        – <p>Filter kind (default: <code>high</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>data</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>Filtered input data.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="k">def</span> <span class="nf">polynominal_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">):</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    Apply polynominal filter to input data.</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        Input data.</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    order : int, optional</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        Filter order (default: `3`).</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">    kind : str, optional</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Filter kind (default: `high`).</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    -------</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">        Filtered input data.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="n">order</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span><span class="p">:</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="n">data</span> <span class="o">-=</span> <span class="n">fit</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;low&#39;</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="n">fit</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;filter kind `</span><span class="si">{kind}</span><span class="s1">` is not available&#39;</span><span class="p">)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.filter_interp_1d" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_interp_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;IQR&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">filter_boundaries</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.filter_interp_1d" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove outliers using the IQR (inter-quartile range) method and
interpolate using user-specified <code>kind</code> (default: 'cubic').
Return outlier-removed and interpolated input array.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input data (1D).</p>
      </li>
      <li class="field-body">
        <b>method</b>
            (<code>str, optional</code>)
        – <p>Filter method to use (default: <code>IQR</code>).</p>
      </li>
      <li class="field-body">
        <b>kind</b>
            (<code>str, optional</code>)
        – <p>Interpolation method for scipy.interpolate.interp1d (default: <code>cubic</code>).</p>
      </li>
      <li class="field-body">
        <b>win</b>
            (<code>int, optional</code>)
        – <p>Size of moving window if required by chosen method (default: <code>11</code>).</p>
      </li>
      <li class="field-body">
        <b>threshold</b>
            (<code>float, optional</code>)
        – <p>Threshold used for median absolute deviation (MAD) (default: <code>3.0</code>).</p>
      </li>
      <li class="field-body">
        <b>filter_boundaries</b>
            (<code>bool, optional</code>)
        – <p>Filter flagged outlier indices at start and end of input array to avoid
edge effects (if present despite padding) (default: <code>True</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>data_interp</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>Filtered and interpolated data.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="k">def</span> <span class="nf">filter_interp_1d</span><span class="p">(</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;IQR&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">filter_boundaries</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="p">):</span>  <span class="c1"># noqa</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">    Remove outliers using the IQR (inter-quartile range) method and</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    interpolate using user-specified `kind` (default: &#39;cubic&#39;).</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    Return outlier-removed and interpolated input array.</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">        Input data (1D).</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    method : str, optional</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">        Filter method to use (default: `IQR`).</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    kind : str, optional</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        Interpolation method for scipy.interpolate.interp1d (default: `cubic`).</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    win : int, optional</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        Size of moving window if required by chosen method (default: `11`).</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    threshold : float, optional</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        Threshold used for median absolute deviation (MAD) (default: `3.0`).</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">    filter_boundaries : bool, optional</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        Filter flagged outlier indices at start and end of input array to avoid</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        edge effects (if present despite padding) (default: `True`).</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    -------</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    data_interp : np.ndarray</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        Filtered and interpolated data.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="n">METHODS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IQR&#39;</span><span class="p">,</span> <span class="s1">&#39;z-score&#39;</span><span class="p">,</span> <span class="s1">&#39;r_z-score&#39;</span><span class="p">,</span> <span class="s1">&#39;MAD&#39;</span><span class="p">,</span> <span class="s1">&#39;doubleMAD&#39;</span><span class="p">,</span> <span class="s1">&#39;r_doubleMAD&#39;</span><span class="p">,</span> <span class="s1">&#39;r_singleMAD&#39;</span><span class="p">]</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">KIND_LIST</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="s1">&#39;nearest-up&#39;</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="s1">&#39;zero&#39;</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="s1">&#39;slinear&#39;</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="s1">&#39;quadratic&#39;</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="s1">&#39;cubic&#39;</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="s1">&#39;previous&#39;</span><span class="p">,</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="s1">&#39;next&#39;</span><span class="p">,</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="p">]</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;data must be 1D array!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="k">if</span> <span class="n">kind</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">KIND_LIST</span><span class="p">:</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Parameter `kind` must be one of </span><span class="si">{</span><span class="n">KIND_LIST</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="c1"># get outlier indices</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;IQR&#39;</span><span class="p">:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">iqr_filter</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;z-score&#39;</span><span class="p">:</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;r_z-score&#39;</span><span class="p">:</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">moving_zscore_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="n">win</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;MAD&#39;</span><span class="p">:</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">mad_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;doubleMAD&#39;</span><span class="p">:</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">mad_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;r_doubleMAD&#39;</span><span class="p">:</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">moving_mad_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="n">win</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;double&#39;</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;r_singleMAD&#39;</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">moving_mad_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="n">win</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">mad_mode</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Given method ist not valid. Choose from </span><span class="si">{</span><span class="n">METHODS</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="c1"># filter flagged outlier indices at start and end of input array</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="k">if</span> <span class="n">filter_boundaries</span><span class="p">:</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="c1"># find consecutive flagged values</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="c1">## get differences</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">diff_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="c1">## split into arrays holding consecutive flagged values</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="n">diff_idx_split</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">diff_idx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">diff_idx</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="c1"># check if first index is in input</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="c1"># number of consecutive indices at start (add one due to split location)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="n">n_exclude_start</span> <span class="o">=</span> <span class="n">diff_idx_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>            <span class="c1"># exclude indices from flagged ones</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="n">n_exclude_start</span><span class="p">:]</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="c1"># check last index is in input</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="c1"># number of consecutive indices at end</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="n">n_exclude_end</span> <span class="o">=</span> <span class="n">diff_idx_split</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="c1"># exclude indices from flagged ones</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="o">-</span><span class="n">n_exclude_end</span><span class="p">]</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>    <span class="c1"># compute sampling indices</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="c1"># updated/altered input data</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="c1"># mask outliers for interpolation</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="n">_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="c1"># create interpolation function</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">_interp</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="c1"># interpolate masked values</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="n">data_interp</span> <span class="o">=</span> <span class="n">_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">return</span> <span class="n">data_interp</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.sta_lta_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sta_lta_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nsta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Compute the STA/LTA ratio (short-time-average / longe-time-average)
by continuously calculating the average values of the absolute amplitude
of a seismic trace in two consecutive moving-time windows.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>a</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Seismic trace (1D) or section (2D).</p>
      </li>
      <li class="field-body">
        <b>nsta</b>
            (<code>int</code>)
        – <p>Length of short time average window (samples).</p>
      </li>
      <li class="field-body">
        <b>nlta</b>
            (<code>int</code>)
        – <p>Length of long time average window (samples).</p>
      </li>
      <li class="field-body">
        <b>axis</b>
            (<code>int, optional</code>)
        – <p>Axis for which to compute STA/LTA ratio (default: -1).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
        – <p>Either 1D or 2D array of STA/LTA ratio (per trace).</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.sta_lta_filter--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.sta_lta_filter--fn:1">
<p>Withers et al. (1998) A comparison of select trigger algorithms for automated global seismic phase and event detection,
  <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.116.245&amp;rep=rep1&amp;type=pdf">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.116.245&amp;rep=rep1&amp;type=pdf</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="pseudo_3D_interpolation.functions.filter.sta_lta_filter--fn:2">
<p>Trnkoczy, A. (2012) Understanding and parameter setting of STA/LTA trigger algorithm,
  <a href="https://gfzpublic.gfz-potsdam.de/rest/items/item_4097_3/component/file_4098/content">https://gfzpublic.gfz-potsdam.de/rest/items/item_4097_3/component/file_4098/content</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter--fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="pseudo_3D_interpolation.functions.filter.sta_lta_filter--fn:3">
<p>ObsPy, <a href="https://docs.obspy.org/_modules/obspy/signal/trigger.html#classic_sta_lta_py">https://docs.obspy.org/_modules/obspy/signal/trigger.html#classic_sta_lta_py</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.sta_lta_filter--fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="k">def</span> <span class="nf">sta_lta_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">nsta</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nlta</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>  <span class="c1"># noqa</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">    Compute the STA/LTA ratio (short-time-average / longe-time-average)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    by continuously calculating the average values of the absolute amplitude</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">    of a seismic trace in two consecutive moving-time windows.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    a : np.ndarray</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        Seismic trace (1D) or section (2D).</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">    nsta : int</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        Length of short time average window (samples).</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">    nlta : int</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        Length of long time average window (samples).</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    axis : int, optional</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        Axis for which to compute STA/LTA ratio (default: -1).</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    -------</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        Either 1D or 2D array of STA/LTA ratio (per trace).</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">    References</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    [^1]: Withers et al. (1998) A comparison of select trigger algorithms for automated global seismic phase and event detection,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">          [http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.116.245&amp;rep=rep1&amp;type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.116.245&amp;rep=rep1&amp;type=pdf)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    [^2]: Trnkoczy, A. (2012) Understanding and parameter setting of STA/LTA trigger algorithm,</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">          [https://gfzpublic.gfz-potsdam.de/rest/items/item_4097_3/component/file_4098/content](https://gfzpublic.gfz-potsdam.de/rest/items/item_4097_3/component/file_4098/content)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    [^3]: ObsPy, [https://docs.obspy.org/_modules/obspy/signal/trigger.html#classic_sta_lta_py](https://docs.obspy.org/_modules/obspy/signal/trigger.html#classic_sta_lta_py)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="c1"># calculate moving average</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">sta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="c1"># copy for LTA</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">lta</span> <span class="o">=</span> <span class="n">sta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="c1"># compute the STA and the LTA</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">sta</span><span class="p">[</span><span class="n">nsta</span><span class="p">:]</span> <span class="o">=</span> <span class="n">sta</span><span class="p">[</span><span class="n">nsta</span><span class="p">:]</span> <span class="o">-</span> <span class="n">sta</span><span class="p">[:</span><span class="o">-</span><span class="n">nsta</span><span class="p">]</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">sta</span> <span class="o">/=</span> <span class="n">nsta</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="n">lta</span><span class="p">[</span><span class="n">nlta</span><span class="p">:]</span> <span class="o">=</span> <span class="n">lta</span><span class="p">[</span><span class="n">nlta</span><span class="p">:]</span> <span class="o">-</span> <span class="n">lta</span><span class="p">[:</span><span class="o">-</span><span class="n">nlta</span><span class="p">]</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="n">lta</span> <span class="o">/=</span> <span class="n">nlta</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="c1"># pad zeros</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">sta</span><span class="p">[:</span> <span class="n">nlta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">elif</span> <span class="n">a</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">sta</span><span class="p">[</span><span class="n">nsta</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">sta</span><span class="p">[</span><span class="n">nsta</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">sta</span><span class="p">[:</span><span class="o">-</span><span class="n">nsta</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="n">sta</span> <span class="o">/=</span> <span class="n">nsta</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">lta</span><span class="p">[</span><span class="n">nlta</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">lta</span><span class="p">[</span><span class="n">nlta</span><span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">lta</span><span class="p">[:</span><span class="o">-</span><span class="n">nlta</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="n">lta</span> <span class="o">/=</span> <span class="n">nlta</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="c1"># pad zeros</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="n">sta</span><span class="p">[:</span> <span class="n">nlta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="c1"># avoid division by zero!</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">sta</span><span class="p">,</span> <span class="n">lta</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">sta</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">sta</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">lta</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.detect_seafloor_reflection" class="doc doc-heading">
<code class="highlight language-python"><span class="n">detect_seafloor_reflection</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">idx_slice_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nsta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nlta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">win_mad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_mad_post</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_median</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">post_detection_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.detect_seafloor_reflection" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Detect seafloor reflection using the STA/LTA algorithm.
Its commonly applied in seismology that evaluates the ratio of short- and long-term energy density.
The initially sample indices found by the STA/LTA algorithm are used to
create individual search windows per trace (idx - win &lt;= x &lt;= idx + win).
Return indices of maximum amplitude(s) within individual search windows (shape: (ntraces,)).</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input seismic section (samples x traces).</p>
      </li>
      <li class="field-body">
        <b>idx_slice_start</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span>, optional</code>)
        – <p>Index of first non-padded sample in original data.</p>
      </li>
      <li class="field-body">
        <b>nsta</b>
            (<code>TYPE, optional</code>)
        – <p>Length of short time average window (in samples). If <code>None</code>: 0.1% of total samples.</p>
      </li>
      <li class="field-body">
        <b>nlta</b>
            (<code>TYPE, optional</code>)
        – <p>Length of long time average window (in samples). If <code>None</code>: 5% of total samples.</p>
      </li>
      <li class="field-body">
        <b>win</b>
            (<code>int, optional</code>)
        – <p>Number of samples to pad search window with (default: <code>20</code>).
Set search window to <code>win</code> samples deeper and <code>win</code> x 2 samples shallower than baseline.</p>
      </li>
      <li class="field-body">
        <b>win_mad</b>
            (<code>int, optional</code>)
        – <p>Number of traces used for Median Absolute Deviation (MAD) filtering.
If None (default), this window is set to 5% of total traces.</p>
      </li>
      <li class="field-body">
        <b>win_mad_post</b>
            (<code>int, optional</code>)
        – <p>Number of traces used for Median Absolute Deviation (MAD) filtering (after detection).
If None (default), this window is set to 1% of total traces.</p>
      </li>
      <li class="field-body">
        <b>win_median</b>
            (<code>int, optional</code>)
        – <p>Number of traces for rolling median filter, should be odd integer (default: <code>11</code>).</p>
      </li>
      <li class="field-body">
        <b>post_detection_filter</b>
            (<code>bool, optional</code>)
        – <p>Apply optional Median Absolute Deviation (MAD) filtering
after actual seafloor detection (default: <code>True</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
        – <p>Indices of samples at maximum amplitude (per trace).</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-569" name="__codelineno-0-569"></a><span class="k">def</span> <span class="nf">detect_seafloor_reflection</span><span class="p">(</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>    <span class="n">idx_slice_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">nsta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>    <span class="n">nlta</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="n">win</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>    <span class="n">win_mad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="n">win_mad_post</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>    <span class="n">win_median</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="n">post_detection_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="p">):</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">    Detect seafloor reflection using the STA/LTA algorithm.</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">    Its commonly applied in seismology that evaluates the ratio of short- and long-term energy density.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    The initially sample indices found by the STA/LTA algorithm are used to</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    create individual search windows per trace (idx - win &lt;= x &lt;= idx + win).</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    Return indices of maximum amplitude(s) within individual search windows (shape: (ntraces,)).</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">        Input seismic section (samples x traces).</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">    idx_slice_start : np.ndarray, optional</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">        Index of first non-padded sample in original data.</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    nsta : TYPE, optional</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        Length of short time average window (in samples). If `None`: 0.1% of total samples.</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    nlta : TYPE, optional</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        Length of long time average window (in samples). If `None`: 5% of total samples.</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    win : int, optional</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        Number of samples to pad search window with (default: `20`).</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">        Set search window to `win` samples deeper and `win` x 2 samples shallower than baseline.</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    win_mad : int, optional</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        Number of traces used for Median Absolute Deviation (MAD) filtering.</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">        If None (default), this window is set to 5% of total traces.</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    win_mad_post : int, optional</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">        Number of traces used for Median Absolute Deviation (MAD) filtering (after detection).</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a><span class="sd">        If None (default), this window is set to 1% of total traces.</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a><span class="sd">    win_median : int, optional</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a><span class="sd">        Number of traces for rolling median filter, should be odd integer (default: `11`).</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a><span class="sd">    post_detection_filter : bool, optional</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a><span class="sd">        Apply optional Median Absolute Deviation (MAD) filtering</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a><span class="sd">        after actual seafloor detection (default: `True`).</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a><span class="sd">    -------</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a><span class="sd">        Indices of samples at maximum amplitude (per trace).</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="n">nsamples</span><span class="p">,</span> <span class="n">ntraces</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="c1"># check for zero traces (e.g. from merging)</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="n">cnt_zero_traces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="n">n_zero_traces</span> <span class="o">=</span> <span class="n">ntraces</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">cnt_zero_traces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="c1"># mask zero traces if found</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">if</span> <span class="n">n_zero_traces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="n">mask_nonzero_traces</span> <span class="o">=</span> <span class="n">cnt_zero_traces</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">mask_nonzero_traces</span><span class="p">]</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="k">if</span> <span class="n">nsta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">nsta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">nsamples</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">))</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>    <span class="k">if</span> <span class="n">nlta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">nlta</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">nsamples</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">))</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="k">if</span> <span class="n">nsta</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="n">nsta</span> <span class="o">=</span> <span class="mi">3</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="n">nlta</span> <span class="o">=</span> <span class="mi">50</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[WARNING]    Changed nsta=</span><span class="si">{</span><span class="n">nsta</span><span class="si">}</span><span class="s1"> and nlta=</span><span class="si">{</span><span class="n">nlta</span><span class="si">}</span><span class="s1">!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>    <span class="c1"># (1) calc standard STA/LTA from data array</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>    <span class="n">sta_lta</span> <span class="o">=</span> <span class="n">sta_lta_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nsta</span><span class="p">,</span> <span class="n">nlta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="c1"># (2) detect first significant amplitude peak (sample indices)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="c1"># CAUTION: could be outlier (e.g. noise bursts in water column)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="c1">#          but that misdetection will be filtered in the subsequent step!</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>    <span class="n">idx_sta_lta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sta_lta</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="k">if</span> <span class="n">idx_slice_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>        <span class="n">idx_sta_lta</span> <span class="o">+=</span> <span class="n">idx_slice_start</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>    <span class="k">if</span> <span class="n">idx_slice_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="c1"># (3) replace seafloor detections outside sample range with median value</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">idx_sta_lta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>            <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">idx_sta_lta</span> <span class="o">&gt;</span> <span class="n">nsamples</span> <span class="o">-</span> <span class="n">idx_slice_start</span><span class="p">,</span> <span class="n">idx_sta_lta</span> <span class="o">&lt;</span> <span class="n">idx_slice_start</span><span class="p">),</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>            <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">idx_sta_lta</span><span class="p">),</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">idx_sta_lta</span><span class="p">,</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="p">)</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>    <span class="c1"># # (3) outlier detection &amp; removal  # TODO: unnecessary?</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="k">if</span> <span class="n">win_mad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="n">win_mad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx_sta_lta</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.02</span><span class="p">)</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">win_mad</span> <span class="o">=</span> <span class="n">win_mad</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">win_mad</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">win_mad</span>  <span class="c1"># must be odd</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">win_mad</span> <span class="o">=</span> <span class="mi">7</span> <span class="k">if</span> <span class="n">win_mad</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="n">win_mad</span>                 <span class="c1"># at least 7 traces</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>    <span class="n">idx_sta_lta</span> <span class="o">=</span> <span class="n">filter_interp_1d</span><span class="p">(</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>        <span class="n">idx_sta_lta</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;r_doubleMAD&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="n">win_mad</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="c1"># (4) apply moving median filter to remove large outliers</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="n">idx_sta_lta</span> <span class="o">=</span> <span class="n">moving_median</span><span class="p">(</span><span class="n">idx_sta_lta</span><span class="p">,</span> <span class="n">win_median</span><span class="p">,</span> <span class="n">padded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>    <span class="c1"># (5) detect `actual` first break amplitude</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="c1"># init index array</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="n">idx_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nsamples</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="c1"># create mask from slices (upper index &lt;= slice &lt;= lower index)</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="n">idx_upper</span><span class="p">,</span> <span class="n">idx_lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx_sta_lta</span> <span class="o">-</span> <span class="n">win</span><span class="p">),</span> <span class="p">(</span><span class="n">idx_sta_lta</span> <span class="o">+</span> <span class="n">win</span><span class="p">)</span>  <span class="c1"># *2</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx_arr</span> <span class="o">&gt;=</span> <span class="n">idx_upper</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">idx_arr</span> <span class="o">&lt;=</span> <span class="n">idx_lower</span><span class="p">)</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="c1"># get indices from mask</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="c1"># subset input array using indices of search window</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">sta_lta_win</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="c1"># get `n` largest values for each trace subset</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="c1"># n = 5</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>    <span class="n">idx_nlargest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="o">-</span><span class="n">sta_lta_win</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="c1"># sort the indices for each trace (ascending order)</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="n">idx_nlargest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="n">idx_nlargest</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">idx_nlargest</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>    <span class="p">)</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>    <span class="c1"># get indices to split `idx_nlargest` into groups of different peak amplitudes</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>    <span class="n">idx_nlargest_sel</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">n</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">idx_nlargest</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>    <span class="p">]</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>    <span class="c1"># split the index array of `n` largest values and select first significant (positive) amplitude</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="n">idx_nlargest_sel</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">tr</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="k">for</span> <span class="n">tr</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx_nlargest</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">idx_nlargest_sel</span><span class="p">)</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="p">]</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="c1"># get index of max. amplitude within selected maxima of first significant (positive) amplitude (NOTE: subset index!)</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="n">idx_peak_amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="p">[</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="n">nlarge</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>            <span class="k">for</span> <span class="n">nlarge</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idx_nlargest</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">sta_lta_win</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">idx_nlargest_sel</span><span class="p">)</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>        <span class="p">]</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="p">)</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>    <span class="c1"># convert subset indices to indices of seismic section</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>    <span class="n">idx_peak_amp</span> <span class="o">+=</span> <span class="n">idx_upper</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="k">if</span> <span class="n">n_zero_traces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ntraces</span><span class="p">)</span>  <span class="c1"># create trace idx WITH zero traces</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="n">x_masked</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">mask_nonzero_traces</span><span class="p">]</span>  <span class="c1"># masked zero traces</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="c1"># create interpolation function</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">_interp</span> <span class="o">=</span> <span class="n">interp</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x_masked</span><span class="p">,</span> <span class="n">idx_peak_amp</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="c1"># interpolate masked indices of zero traces</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="n">idx_peak_amp</span> <span class="o">=</span> <span class="n">_interp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="c1"># (6) additional outlier detection &amp; removal</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="k">if</span> <span class="n">post_detection_filter</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="k">if</span> <span class="n">win_mad_post</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="n">win_mad_post</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx_sta_lta</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">)</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>            <span class="n">win_mad_post</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                <span class="n">win_mad_post</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">win_mad_post</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">win_mad_post</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="p">)</span>  <span class="c1"># must be odd</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="n">win_mad_post</span> <span class="o">=</span> <span class="mi">7</span> <span class="k">if</span> <span class="n">win_mad_post</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="n">win_mad_post</span>  <span class="c1"># at least 7 traces</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="n">idx_peak_amp</span> <span class="o">=</span> <span class="n">filter_interp_1d</span><span class="p">(</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">idx_peak_amp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;r_doubleMAD&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">win</span><span class="o">=</span><span class="n">win_mad_post</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>        <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>    <span class="k">return</span> <span class="n">idx_peak_amp</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.butterworth_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">butterworth_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">btype</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.butterworth_filter" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply butterworth filter to input signal. Can be <code>lowpass</code>, <code>highpass</code>, or <code>bandpass</code>.</p>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input data.</p>
      </li>
      <li class="field-body">
        <b>cutoff</b>
            (<code>float | tuple</code>)
        – <p>Cutoff frequency (in Hz).</p>
      </li>
      <li class="field-body">
        <b>fs</b>
            (<code>float</code>)
        – <p>Sampling frequency (in Hz).</p>
      </li>
      <li class="field-body">
        <b>order</b>
            (<code>int, optional</code>)
        – <p>Butterworth filter order (default: 9).</p>
      </li>
      <li class="field-body">
        <b>axis</b>
            (<code>int, optional</code>)
        – <p>The axis of x to which the filter is applied (default: -1).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b>y</b>(            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
)        – <p>Filtered input signal.</p>
      </li>
  </ul>
      <h5 id="pseudo_3D_interpolation.functions.filter.butterworth_filter--references">References<a class="headerlink" href="#pseudo_3D_interpolation.functions.filter.butterworth_filter--references" title="Permanent link">#</a></h5>
<div class="footnote">
<hr />
<ol>
<li id="pseudo_3D_interpolation.functions.filter.butterworth_filter--fn:1">
<p><a href="https://stackoverflow.com/a/48677312">https://stackoverflow.com/a/48677312</a>&#160;<a class="footnote-backref" href="#pseudo_3D_interpolation.functions.filter.butterworth_filter--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="k">def</span> <span class="nf">butterworth_filter</span><span class="p">(</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">btype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">fs</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a><span class="sd">    Apply butterworth filter to input signal. Can be `lowpass`, `highpass`, or `bandpass`.</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">        Input data.</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">    cutoff : float | tuple</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        Cutoff frequency (in Hz).</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">    fs : float</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        Sampling frequency (in Hz).</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">    order : int, optional</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        Butterworth filter order (default: 9).</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">    axis : int, optional</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        The axis of x to which the filter is applied (default: -1).</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">    -------</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    y : np.ndarray</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">        Filtered input signal.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">    References</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">    [^1]: [https://stackoverflow.com/a/48677312](https://stackoverflow.com/a/48677312)</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>    <span class="k">if</span> <span class="n">btype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="s1">&#39;highpass&#39;</span><span class="p">,</span> <span class="s1">&#39;bandpass&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;``btype`` has to be ``lowpass``, ``highpass``, or ``bandpass``!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">_butterworth_filter_coefficients</span><span class="p">(</span><span class="n">btype</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>    <span class="k">return</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pseudo_3D_interpolation.functions.filter.filter_frequency" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_frequency</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pseudo_3D_interpolation.functions.filter.filter_frequency" class="headerlink" title="Permanent link">#</a></h3>


  <div class="doc doc-contents ">
  
      <p>Apply freqeuncy filter by specifing passband and stopband frequencies.
Possible filter types:</p>
<ul>
<li><code>bandpass</code>:     freqs = [<em>f1</em>, <em>f2</em>, <em>f3</em>, <em>f4</em>]</li>
<li><code>lowpass</code>:      freqs = [<em>f_stopband</em>, <em>f_cutoff</em>]</li>
<li><code>highpass</code>:     freqs = [<em>f_cutoff</em>, <em>f_stopband</em>]</li>
</ul>

  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b>data</b>
            (<code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>)
        – <p>Input data.</p>
      </li>
      <li class="field-body">
        <b>freqs</b>
            (<code>list</code>)
        – <p>List of frequencies defining filter (same unit as <code>fs</code>!).</p>
      </li>
      <li class="field-body">
        <b>fs</b>
            (<code>float</code>)
        – <p>Sampling frequency (in Hz).</p>
      </li>
      <li class="field-body">
        <b>filter_type</b>
            (<code>str</code>)
        – <p>Filter type to apply (<code>bandpass</code>, <code>lowpass</code>, <code>highpass</code>)</p>
      </li>
      <li class="field-body">
        <b>gpass</b>
            (<code>int, optional</code>)
        – <p>The maximum loss in the passband (dB).</p>
      </li>
      <li class="field-body">
        <b>gstop</b>
            (<code>int, optional</code>)
        – <p>The minimum attenuation in the stopband (dB).</p>
      </li>
      <li class="field-body">
        <b>axis</b>
            (<code>int, optional</code>)
        – <p>The axis of x to which the filter is applied (default: <code>-1</code>).</p>
      </li>
  </ul>

  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
        – <p>Filtered input data.</p>
      </li>
  </ul>

      <details class="quote">
        <summary>Source code in <code>pseudo_3D_interpolation\functions\filter.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="k">def</span> <span class="nf">filter_frequency</span><span class="p">(</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>    <span class="n">freqs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>    <span class="n">fs</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="n">filter_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>    <span class="n">gpass</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>    <span class="n">gstop</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">    Apply freqeuncy filter by specifing passband and stopband frequencies.</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">    Possible filter types:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">      - `bandpass`:     freqs = [*f1*, *f2*, *f3*, *f4*]</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">      - `lowpass`:      freqs = [*f_stopband*, *f_cutoff*]</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">      - `highpass`:     freqs = [*f_cutoff*, *f_stopband*]</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">    data : np.ndarray</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">        Input data.</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">    freqs : list</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        List of frequencies defining filter (same unit as `fs`!).</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">    fs : float</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        Sampling frequency (in Hz).</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">    filter_type : str</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        Filter type to apply (`bandpass`, `lowpass`, `highpass`)</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">    gpass : int, optional</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        The maximum loss in the passband (dB).</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    gstop : int, optional</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a><span class="sd">        The minimum attenuation in the stopband (dB).</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a><span class="sd">    axis : int, optional</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a><span class="sd">        The axis of x to which the filter is applied (default: `-1`).</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="sd">    -------</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a><span class="sd">        Filtered input data.</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="k">if</span> <span class="n">filter_type</span> <span class="o">==</span> <span class="s1">&#39;bandpass&#39;</span><span class="p">:</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="n">wp</span> <span class="o">=</span> <span class="p">[</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">freqs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="n">ws</span> <span class="o">=</span> <span class="p">[</span><span class="n">freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">freqs</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">freqs</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">freqs</span><span class="p">):</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid filter frequencies!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>    <span class="k">elif</span> <span class="n">filter_type</span> <span class="o">==</span> <span class="s1">&#39;lowpass&#39;</span><span class="p">:</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>        <span class="n">wp</span><span class="p">,</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">freqs</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="k">if</span> <span class="n">wp</span> <span class="o">&gt;</span> <span class="n">ws</span><span class="p">:</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid filter frequencies!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>    <span class="k">elif</span> <span class="n">filter_type</span> <span class="o">==</span> <span class="s1">&#39;highpass&#39;</span><span class="p">:</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="n">wp</span><span class="p">,</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">freqs</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="k">if</span> <span class="n">wp</span> <span class="o">&lt;</span> <span class="n">ws</span><span class="p">:</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid filter frequencies!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="c1"># get Butterworth filter order and natural frequency</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>    <span class="n">N</span><span class="p">,</span> <span class="n">Wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="p">,</span> <span class="n">ws</span><span class="p">,</span> <span class="n">gpass</span><span class="p">,</span> <span class="n">gstop</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="c1"># filter coefficients</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="n">filter_type</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>    <span class="k">return</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>



  



                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Fynn Warnke
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/fwrnke" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M352 256c0 22.2-1.2 43.6-3.3 64H163.3c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64h185.4c2.2 20.4 3.3 41.8 3.3 64zm28.8-64h123.1c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64H380.8c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32H376.7c-10-63.9-29.8-117.4-55.3-151.6 78.3 20.7 142 77.5 171.9 151.6zm-149.1 0H167.7c6.1-36.4 15.5-68.6 27-94.7 10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5 11.6 26 21 58.2 27 94.7zm-209 0H18.6c30-74.1 93.6-130.9 172-151.6-25.5 34.2-45.3 87.7-55.3 151.6zM8.1 192h123.1c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64H8.1C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zm186.6 254.6c-11.6-26-20.9-58.2-27-94.6h176.6c-6.1 36.4-15.5 68.6-27 94.6-10.5 23.6-22.2 40.7-33.5 51.5-11.2 10.7-20.5 13.9-27.8 13.9s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6-78.4-20.7-142-77.5-172-151.6h116.7zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6 25.5-34.2 45.2-87.7 55.3-151.6h116.6z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/fwrnke" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/fwrnke" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.researchgate.net/profile/Fynn-Warnke" target="_blank" rel="noopener" title="www.researchgate.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M0 32v448h448V32H0zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7v7.3zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9zm-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://linkedin.com/in/fynn-warnke" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://orcid.org/0000-0002-7477-5058" target="_blank" rel="noopener" title="orcid.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M294.75 188.19h-45.92V342h47.47c67.62 0 83.12-51.34 83.12-76.91 0-41.64-26.54-76.9-84.67-76.9zM256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-80.79 360.76h-29.84v-207.5h29.84zm-14.92-231.14a19.57 19.57 0 1 1 19.57-19.57 19.64 19.64 0 0 1-19.57 19.57zM300 369h-81V161.26h80.6c76.73 0 110.44 54.83 110.44 103.85C410 318.39 368.38 369 300 369z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["search.highlight", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.a00a7c5e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>